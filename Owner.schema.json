{
  "$defs": {
    "Status": {
      "enum": [
        "active",
        "blocked",
        "in_deletion"
      ],
      "title": "Status",
      "type": "string"
    }
  },
  "additionalProperties": false,
  "properties": {
    "owner_hash": {
      "description": "URL-safe base64 (43 chars, e.g. for SHA256-url-encoded hash) as unique pseudonymous ID",
      "maxLength": 43,
      "minLength": 43,
      "pattern": "^[A-Za-z0-9_-]{43}$",
      "title": "Owner Hash",
      "type": "string"
    },
    "salt": {
      "description": "bcrypt salt string",
      "maxLength": 22,
      "minLength": 22,
      "pattern": "^[A-Za-z0-9./]{22}$",
      "title": "Salt",
      "type": "string"
    },
    "password_hash": {
      "description": "bcrypt hash string, 60 chars",
      "maxLength": 60,
      "minLength": 60,
      "pattern": "^\\$2[aby]\\$[0-9]{2}\\$[A-Za-z0-9./]{53}$",
      "title": "Password Hash",
      "type": "string"
    },
    "public_key": {
      "description": "PEM encoded public key",
      "maxLength": 800,
      "minLength": 272,
      "pattern": "^-----BEGIN PUBLIC KEY-----(.|\\n)+-----END PUBLIC KEY-----\\n?$",
      "title": "Public Key",
      "type": "string"
    },
    "random_entropy": {
      "description": "Random hex-encoded entropy (32-64 chars, for cryptographic purposes)",
      "maxLength": 64,
      "minLength": 32,
      "pattern": "^[A-Fa-f0-9]{32,64}$",
      "title": "Random Entropy",
      "type": "string"
    },
    "created_at": {
      "description": "Unix timestamp when the owner was created",
      "title": "Created At",
      "type": "integer"
    },
    "status": {
      "$ref": "#/$defs/Status",
      "default": "active",
      "description": "Owner account status flag: active, blocked, or pending deletion"
    }
  },
  "required": [
    "owner_hash",
    "salt",
    "password_hash",
    "public_key",
    "random_entropy",
    "created_at"
  ],
  "title": "Owner",
  "type": "object"
}